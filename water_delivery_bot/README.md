# üö∞ –ë–æ—Ç –¥–æ—Å—Ç–∞–≤–∫–∏ –≤–æ–¥–∏ "–ï—Ñ–µ–∫—Ç"

Telegram –±–æ—Ç –¥–ª—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –¥–æ—Å—Ç–∞–≤–∫–∏ –±—É—Ç–∏–ª—å–æ–≤–∞–Ω–æ—ó –≤–æ–¥–∏.

## üìã –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª

### –î–ª—è –∫–ª—ñ—î–Ω—Ç—ñ–≤:
- üìù –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è (–ü–Ü–ë, —Ç–µ–ª–µ—Ñ–æ–Ω, –∞–¥—Ä–µ—Å–∞)
- üõí –û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è (–≤–∏–±—ñ—Ä —Ç–∏–ø—É –≤–æ–¥–∏, –∫—ñ–ª—å–∫–æ—Å—Ç—ñ, —Å–ø–æ—Å–æ–±—É –æ–ø–ª–∞—Ç–∏)
- üìã –ü–µ—Ä–µ–≥–ª—è–¥ —ñ—Å—Ç–æ—Ä—ñ—ó –∑–∞–º–æ–≤–ª–µ–Ω—å
- ‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é
- ‚≠ê –û—Ü—ñ–Ω–∫–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –ø—ñ—Å–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è

### –î–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤:
- üìã –ü–µ—Ä–µ–≥–ª—è–¥ —Ç–∞ –æ–±—Ä–æ–±–∫–∞ –∑–∞–º–æ–≤–ª–µ–Ω—å
- üí∞ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∏—Ö —Ü—ñ–Ω –¥–ª—è –∫–ª—ñ—î–Ω—Ç—ñ–≤
- üë• –ü–µ—Ä–µ–≥–ª—è–¥ —Å–ø–∏—Å–∫—É –∫–ª—ñ—î–Ω—Ç—ñ–≤
- ‚ö†Ô∏è –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ñ –≤—ñ–¥–≥—É–∫–∏

### –¢–∏–ø–∏ –≤–æ–¥–∏:
- üíß –í–æ–¥–∞ –ï—Ñ–µ–∫—Ç 19–ª
- ‚òï –í–æ–¥–∞ –ï—Ñ–µ–∫—Ç –¥–ª—è –∫–∞–≤–∏ 19–ª

---

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç (–ª–æ–∫–∞–ª—å–Ω–æ)

### 1. –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é
```bash
git clone <repository-url>
cd water_delivery_bot
```

### 2. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
```bash
python -m venv .venv
source .venv/bin/activate  # Linux/Mac
# –∞–±–æ
.venv\Scripts\activate  # Windows
```

### 3. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```

### 4. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
```bash
cp env.example .env
nano .env  # —Ä–µ–¥–∞–≥—É—î–º–æ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é
```

–ó–∞–ø–æ–≤–Ω—ñ—Ç—å `.env`:
```env
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–≤—ñ–¥_BotFather
ADMIN_IDS=–≤–∞—à_telegram_id
DEFAULT_BOTTLE_PRICE=150
```

### 5. –ó–∞–ø—É—Å–∫
```bash
python main.py
```

---

## üñ•Ô∏è –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –Ω–∞ Ubuntu VPS

### –ö—Ä–æ–∫ 1: –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞
```bash
ssh root@–≤–∞—à_ip_—Å–µ—Ä–≤–µ—Ä–∞
```

### –ö—Ä–æ–∫ 2: –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏
```bash
apt update && apt upgrade -y
```

### –ö—Ä–æ–∫ 3: –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Python —Ç–∞ –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –ø–∞–∫–µ—Ç—ñ–≤
```bash
apt install python3 python3-pip python3-venv git -y
```

### –ö—Ä–æ–∫ 4: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–ª—è –±–æ—Ç–∞
```bash
useradd -m -s /bin/bash botuser
su - botuser
```

### –ö—Ä–æ–∫ 5: –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é
```bash
cd ~
git clone <repository-url> water_delivery_bot
cd water_delivery_bot
```

–ê–±–æ —Å–∫–æ–ø—ñ—é–π—Ç–µ —Ñ–∞–π–ª–∏ —á–µ—Ä–µ–∑ SCP:
```bash
# –ó –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–∞—à–∏–Ω–∏:
scp -r /path/to/water_delivery_bot root@–≤–∞—à_ip:~
```

### –ö—Ä–æ–∫ 6: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
```bash
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

### –ö—Ä–æ–∫ 7: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
```bash
cp env.example .env
nano .env
```

–ó–∞–ø–æ–≤–Ω—ñ—Ç—å:
```env
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–≤—ñ–¥_BotFather
ADMIN_IDS=–≤–∞—à_telegram_id
DEFAULT_BOTTLE_PRICE=150
```

### –ö—Ä–æ–∫ 8: –¢–µ—Å—Ç–æ–≤–∏–π –∑–∞–ø—É—Å–∫
```bash
python main.py
```
–Ø–∫—â–æ –≤—Å–µ –ø—Ä–∞—Ü—é—î, –∑—É–ø–∏–Ω—ñ—Ç—å (Ctrl+C) —ñ –Ω–∞–ª–∞—à—Ç—É–π—Ç–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫.

---

## ‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è systemd (–∞–≤—Ç–æ–∑–∞–ø—É—Å–∫)

### –ö—Ä–æ–∫ 1: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è service —Ñ–∞–π–ª—É
```bash
sudo nano /etc/systemd/system/water-bot.service
```

–í—Å—Ç–∞–≤—Ç–µ:
```ini
[Unit]
Description=Water Delivery Telegram Bot
After=network.target

[Service]
Type=simple
User=botuser
WorkingDirectory=/home/botuser/water_delivery_bot
Environment=PATH=/home/botuser/water_delivery_bot/.venv/bin
ExecStart=/home/botuser/water_delivery_bot/.venv/bin/python main.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

### –ö—Ä–æ–∫ 2: –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Ç–∞ –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤—ñ—Å—É
```bash
sudo systemctl daemon-reload
sudo systemctl enable water-bot
sudo systemctl start water-bot
```

### –ö—Ä–æ–∫ 3: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
```bash
sudo systemctl status water-bot
```

### –ö–æ—Ä–∏—Å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏:
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞
sudo systemctl restart water-bot

# –ó—É–ø–∏–Ω–∫–∞ –±–æ—Ç–∞
sudo systemctl stop water-bot

# –ü–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤
sudo journalctl -u water-bot -f

# –ü–µ—Ä–µ–≥–ª—è–¥ –æ—Å—Ç–∞–Ω–Ω—ñ—Ö 100 —Ä—è–¥–∫—ñ–≤ –ª–æ–≥—ñ–≤
sudo journalctl -u water-bot -n 100
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
water_delivery_bot/
‚îú‚îÄ‚îÄ main.py              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥—É
‚îú‚îÄ‚îÄ config.py            # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
‚îú‚îÄ‚îÄ database.py          # –†–æ–±–æ—Ç–∞ –∑ –ë–î
‚îú‚îÄ‚îÄ keyboards.py         # –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∏
‚îú‚îÄ‚îÄ states.py            # FSM —Å—Ç–∞–Ω–∏
‚îú‚îÄ‚îÄ handlers/            # –û–±—Ä–æ–±–Ω–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ common.py        # –ó–∞–≥–∞–ª—å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏
‚îÇ   ‚îú‚îÄ‚îÄ registration.py  # –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è
‚îÇ   ‚îú‚îÄ‚îÄ orders.py        # –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è
‚îÇ   ‚îî‚îÄ‚îÄ admin.py         # –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ water_delivery.db  # –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö (—Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ)
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ .env                 # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è (—Å—Ç–≤–æ—Ä—ñ—Ç—å –∑ env.example)
‚îú‚îÄ‚îÄ env.example
‚îî‚îÄ‚îÄ README.md
```

---

## üîß –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è (.env)

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å | –ü—Ä–∏–∫–ª–∞–¥ |
|----------|------|---------|
| `BOT_TOKEN` | –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –≤—ñ–¥ @BotFather | `123456:ABC...` |
| `ADMIN_IDS` | Telegram ID –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤ (—á–µ—Ä–µ–∑ –∫–æ–º—É) | `123456789,987654321` |
| `DEFAULT_BOTTLE_PRICE` | –¶—ñ–Ω–∞ –∑–∞ –ø–ª—è—à–∫—É –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º (–≥—Ä–Ω) | `150` |

---

## üì± –ö–æ–º–∞–Ω–¥–∏ –±–æ—Ç–∞

### –î–ª—è –≤—Å—ñ—Ö:
- `/start` - –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é
- `/help` - –î–æ–≤—ñ–¥–∫–∞
- `/prices` - –¶—ñ–Ω–∏ (–¥–ª—è –∞–¥–º—ñ–Ω—ñ–≤ - —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ü—ñ–Ω–∞–º–∏)
- `/contacts` - –ö–æ–Ω—Ç–∞–∫—Ç–∏

### –î–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤:
- `/admin` - –ü–∞–Ω–µ–ª—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

---

## üîÑ –û–Ω–æ–≤–ª–µ–Ω–Ω—è –±–æ—Ç–∞

```bash
# –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—å –¥–æ —Å–µ—Ä–≤–µ—Ä–∞
ssh root@–≤–∞—à_ip

# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –±–æ—Ç–∞
cd /home/botuser/water_delivery_bot

# –û–Ω–æ–≤–∏—Ç–∏ –∫–æ–¥ (—è–∫—â–æ git)
git pull

# –ê–±–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤—ñ —Ñ–∞–π–ª–∏ —á–µ—Ä–µ–∑ SCP

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ –±–æ—Ç–∞
sudo systemctl restart water-bot

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å
sudo systemctl status water-bot
```

---

## üõ°Ô∏è –†–µ–∑–µ—Ä–≤–Ω–µ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è

### –ë–µ–∫–∞–ø –±–∞–∑–∏ –¥–∞–Ω–∏—Ö:
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ
cp /home/botuser/water_delivery_bot/data/water_delivery.db ~/backup_$(date +%Y%m%d).db

# –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É –º–∞—à–∏–Ω—É
scp root@–≤–∞—à_ip:~/backup_*.db ./backups/
```

---

## ‚ùì –í–∏—Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º

### –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏
sudo journalctl -u water-bot -n 50

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É
ls -la /home/botuser/water_delivery_bot/
```

### –ü–æ–º–∏–ª–∫–∞ –∑ —Ç–æ–∫–µ–Ω–æ–º
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞ –≤ `.env`
- –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å, —â–æ —Ñ–∞–π–ª `.env` —ñ—Å–Ω—É—î

### –ü–æ–º–∏–ª–∫–∞ –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—Ä–∞–≤–∞ –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é data
ls -la /home/botuser/water_delivery_bot/data/
chmod 755 /home/botuser/water_delivery_bot/data/
```

---

## üìû –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–Ø–∫—â–æ –≤–∏–Ω–∏–∫–ª–∏ –ø–∏—Ç–∞–Ω–Ω—è - –∑–≤'—è–∂—ñ—Ç—å—Å—è –∑ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–æ–º.
